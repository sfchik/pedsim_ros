<launch>
  <arg name="initial_x" default="4.0"/>  <!-- 2.0 -->
  <arg name="initial_y" default="6.0"/>
  <arg name="initial_theta" default="0.0"/> 

  <arg name="teleop" default="false"/>

  <!-- params --> 
  <!-- pedsim_msg_test.xml, corridor_fke_group_ped.xml, corridor_fke.xml, corridor_fke_irl.xml-->
  <param name="/pedsim/scene_file" value="$(find pedsim_simulator)scenarios/corridor_fke_group_ped.xml" type="string"/>
  <param name="/use_sim_time" value="false"/>

  <!-- main simulator node -->
  <node name="pedsim_simulator" pkg="pedsim_simulator" type="simulator" output="screen"/>

  <!-- Rviz -->
  <node pkg="rviz" type="rviz" name="rviz" args="-d $(find pedsim_simulator)/rviz/social_contexts_activities.rviz"/>


  <group ns="/pedbot/control">
    <!-- robot driving controller -->
    <node name="driving_controller" type="simulate_diff_drive_robot" pkg="pedsim_simulator" output="screen">
        <param name="pose_initial_x" value="$(arg initial_x)"/>
        <param name="pose_initial_y" value="$(arg initial_y)"/>
        <param name="pose_initial_theta" value="$(arg initial_theta)"/>  <!-- default settings x 4.0, y 4.0 theta 0.7 -->
    </node>

    <!-- RQT robot steering
    <node pkg="rqt_robot_steering" name="rqt_robot_steering" type="rqt_robot_steering" if="$(arg teleop)">
        <remap from="/cmd_vel" to="/pedbot/control/cmd_vel"/>
    </node>  -->
  </group>

  <!-- NODES -->
  <node name="pedsim_point_clouds" pkg="pedsim_point_clouds" type="pedsim_point_clouds" output="screen"/> 
  <param name="/pedsim_point_clouds/local_width" value="8.0" type="double"/>  <!-- this is to adjust the sensing range -->
  <param name="/pedsim_point_clouds/local_height" value="8.0" type="double"/>


  <include file="$(find my_pedsim_nav)/launch/move_base.launch">
    <arg name="goal_x" default="14.1"/>
    <arg name="goal_y" default="6.0"/>
    <arg name="goal_yaw" default="0.0"/>
    <arg name="pose_initial_x" default="$(arg initial_x)"/>
    <arg name="pose_initial_y" default="$(arg initial_y)"/>
    <arg name="pose_initial_theta" default="$(arg initial_theta)"/>    
    <arg name="s_x_extra" default="0.1"/>
  </include>

</launch>
